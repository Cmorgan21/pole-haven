{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}

{% block header %}
{% endblock header %}
{% block content %}
<link rel="stylesheet" type="text/css" href="{% static 'css/blog_styles.css' %}">
<div class="container">
    <div class="img-container">
        <img class="blog-image" src="{% if 'placeholder' in post.featured_image.url %}{% static 'images/default.jpg' %}{% else %}{{ post.featured_image.url }}{% endif %}" alt="..." />
    </div>
    <div class="content-container">
        <div class="title-container">
            <h1>{{ post.title }}</h1>
        </div>
        <hr>
        <div>
            <p>{{ post.content | safe }}</p>
            <p>Created by {{ post.author }}<br> on {{ post.created_on }}</p>
        </div>
        <hr>
        <div class="comment-container">
            {% if comment_count == 0 %}
            <h4>No comments have been made</h4>
            {% else %}
            <h4>{{ comment_count }} Comments:</h4>
            {% endif %}
            <div>
                {% for comment in comments %}
                <div class="p-2 comments">
                {% if comment.approved %}
                  <p class="font-weight-bold">
                    {{ comment.author }} commented:
                  </p>
                  <div id="comment{{ comment.id }}">
                    {{ comment.body }} <br>
                    {{ comment.created_on }}
                  </div>
                  <hr>
                  {% elif not comment.approved and comment.author == user %}

                  <div id="comment{{ comment.id }}" class="approval-text">
                    {{ comment.body }} <br>
                    {{ comment.created_on }}
                  <p class="approval">
                    This comment is awaiting approval
                  </p>
                  {% endif %}
                </div>
                {% endfor %}
                <div class="comment-form-container"></div>
                    <div class="col-md-4 card mb-4 mt-3 form-body">
                        <div class="card-body">
                        {% if user.is_authenticated %}
                        <h3>Leave a comment:</h3>
                        <p>Posting as: {{ user.username }}</p>
                        <form id="commentForm" method="post">
                            {{ comment_form | crispy }}
                            {% csrf_token %}
                            <button id="submitButton" type="submit"
                            class="btn btn-signup btn-lg">Submit</button>
                        </form>
                        {% else %}
                        <p>Log in to leave a comment</p>
                        {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



</div>

{% endblock %}